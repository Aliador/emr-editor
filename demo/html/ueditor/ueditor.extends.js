var parent=window.parent,UE=parent.UE,prevSelectedTd=[];function _onTimeinputHandler(t){if(console.log("on time input value changed"),t){let value=t.value,target=t.parentNode;if(target){var obj=eval("("+target.getAttribute("obj")+")");obj.defaultValue=obj.defaultValue_1=value;var valueEl=target.getElementsByClassName("hxiong-field-value")[0];valueEl&&(valueEl.value=value),target.setAttribute("obj",JSON.stringify(obj).replace(/\"/g,"'"))}}}function _onTdClickHandler(e,t){if(console.log("td click"),t.getElementsByClassName("hxplugin")&&window.mode<2)return console.log("当前模式不支持编辑!"),t.setAttribute("contenteditable",!1),!1;window.mode}function _onBarSpliterClickHandler(e,t){var l,o;t=t||window.event;l=e.getAttribute("index"),o=e.getAttribute("table"),console.log("select col",o,l);for(var a,n=e.parentNode.getElementsByClassName("bar-item-h"),i=0;a=n[i];i++)a.className=a.className.replace(" active","");e.className=e.className+" active";var r=window.parent.UE.UETable.getUETable(document.getElementById(o));r.clearSelected(),r.selectCol(l)}function _onInsertRightColHandler(e,t){var l;t=t||window.event;l=e.getAttribute("table"),window.parent.UE.UETable.getUETable(document.getElementById(l)).insertColAtLast(),window.parent.UE.commands.resizetable.execCommand("resizetable",{tableId:l}),console.log("insert col")}function _onSplitMouseDownHandler(e,t){t=t||window.event;window.parent.resizeInfo=window.resizeInfo={canResize:!0,position:{X:t.clientX,Y:t.clientY},target:t.target.previousSibling,width:t.target.previousSibling.offsetWidth,maxWidth:t.target.ownerDocument.body.offsetWidth},console.log("set can resize,",window.resizeInfo)}function _onTdPClickHandler(e,t){t.setAttribute("contenteditable",!1),_checkWayEdit(e,t)&&(console.log("set this node editable!"),t.setAttribute("contenteditable",!0),t.focus()),console.log("td inner p click")}function _onCheckBoxClickHandler(t){var plugin=t.parentNode.parentNode,obj=eval("("+plugin.getAttribute("obj")+")");if(console.log("required",obj.required),1==obj.required&&window.mode<2&&"single"==obj.mode)for(var checks=plugin.getElementsByTagName("input"),i=0,c;c=checks[i];i++)c.value==t.value?c.checked=!0:c.checked=!1;else if("single"==obj.mode)for(var checks=plugin.getElementsByTagName("input"),i=0,c;c=checks[i];i++)c.value==t.value||(c.checked=!1);if(1==obj.required&&window.mode<2&&"multiple"==obj.mode){for(var checks=plugin.getElementsByTagName("input"),checkeds=[],i=0,c;c=checks[i];i++)c.checked&&checkeds.push(c);0==checkeds.length&&(t.checked=!0)}console.log("checked",t.checked)}function _onInputClickHandler(e){return 0!=window.mode&&(!e.getAttribute("sourceId")&&(e.setAttribute("contenteditable",!0),void e.focus()))}function _onInputBlurHandler(e,t){console.log("hei blur"),t.setAttribute("contenteditable",!1)}function _onInputKeyUpHandler(e,t){let l=t.getAttribute("dataType");if(l&&"number"==l){let e=t.innerText;if(/[^\d]/.test(e)){var o=e.replace(/[^\d]/g,"");t.innerText=o}_countTotalScore4Input(t)}}function _countTotalScore4Input(t){let group=t.getAttribute("group"),text=t.innerText;if(group){let totalEl=document.getElementsByClassName(group);if(!totalEl)return;totalEl=totalEl[0],console.log("do count 4 socre"),text&&""!=text||(text="0");let iValue=parseFloat(text),obj=eval("("+t.parentNode.getAttribute("obj")+")"),realVal=iValue-parseFloat(obj.value);console.log("real value=",realVal);let elObj=eval("("+totalEl.getAttribute("obj")+")");elObj.value&&elObj.value>0?elObj.value=parseFloat(elObj.value)+realVal:elObj.value=realVal,obj.value=iValue,obj.score=iValue;let scoreEl=totalEl.getElementsByClassName("hxiong-field-value")[0];scoreEl&&elObj.value&&(scoreEl.innerHTML=elObj.value);let el1=JSON.stringify(elObj).replace(/\"/g,"'"),obj1=JSON.stringify(obj).replace(/\"/g,"'");t.parentNode.setAttribute("obj",obj1),totalEl.setAttribute("obj",el1)}}function _onInputKeyDownHandler(e){return 0!=window.getSelection().focusOffset||8!=event.keyCode&&46!=event.keyCode&&10!=event.keyCode}function _inputDataTypeCheck4Number(e){return(0!=window.getSelection().focusOffset||110!=e)&&(console.log("do check key code",e),8==e||46==e||110==e||e>=96&&e<=105)}function _onInputKeyDownHandlerExt(e){return 0!=window.getSelection().focusOffset||8!=event.keyCode&&46!=event.keyCode&&10!=event.keyCode}function _onCheckClickHandler(e,t){let obj=eval("("+t.getAttribute("obj")+")"),child=t.getElementsByClassName("hxiong-td-check")[0];obj&&child&&(obj.value?(obj.value=0,child.style.display="none"):(obj.value=1,child.style.display="inherit"),t.setAttribute("obj",JSON.stringify(obj).replace(/\"/g,"'")))}function _onScoreClickHandler(e,t){0!=window.mode&&_toggleTdScoreMethod(t)}function _toggleTdScoreMethod(t,ignore){var ifCheckedReturn=ignore||!1;let domUtils=UE.dom.domUtils,obj=eval("("+t.getAttribute("obj")+")"),table=domUtils.findParentByTagName(t,["table"],!0),totalEl=null;if(obj.totalGroupName){let e=$.md5(obj.totalGroupName);obj.plan&&(e+=obj.plan);let t=document.getElementsByClassName(e);t&&t.length>0&&(totalEl=t[0])&&console.log("could to count total")}if(console.log("score clicked"),obj.groupName&&obj.groupName.length>1){let checks=table.getElementsByClassName("hxiong-td-check");if(!checks||0==checks.length)return;for(let i=0;i<checks.length;i++){let c=checks[i];if(c.getAttribute("group")==obj.group){let p=domUtils.findParentByTagName(c,["p"],!0);if(p){let o=eval("("+p.getAttribute("obj")+")");if(o.nodeId==obj.nodeId)continue;if(o.value){let iValue=parseFloat(o.value);if(totalEl){let elObj=eval("("+totalEl.getAttribute("obj")+")");elObj.value&&elObj.value>0?elObj.value=parseFloat(elObj.value)-iValue:elObj.value=0;let scoreEl=totalEl.getElementsByClassName("hxiong-field-value")[0];scoreEl&&elObj.value&&(scoreEl.innerHTML=elObj.value);let el1=JSON.stringify(elObj).replace(/\"/g,"'");totalEl.setAttribute("obj",el1)}}o.value=null;let os=JSON.stringify(o).replace(/\"/g,"'");p.setAttribute("obj",os),c.style.display="none"}}}let oldVal=obj.value||0;obj.value=obj.value||obj.value>0?null:obj.score,console.log(obj.value),ifCheckedReturn&&parseFloat(oldVal)>0&&(obj.value=oldVal);let child=t.getElementsByClassName("hxiong-td-check")[0];child&&(child.style.display=obj.value?"inherit":"none");let objStr=JSON.stringify(obj).replace(/\"/g,"'");if(t.setAttribute("obj",objStr),totalEl){let elObj=eval("("+totalEl.getAttribute("obj")+")"),realVal=parseFloat(obj.value||0)-parseFloat(oldVal);elObj.value&&elObj.value>0?(console.log(elObj.value),elObj.value=parseFloat(elObj.value)+parseFloat(realVal),console.log(realVal,elObj.value)):elObj.value=parseFloat(realVal);let el1=JSON.stringify(elObj).replace(/\"/g,"'");console.log(el1);let scoreEl=totalEl.getElementsByClassName("hxiong-field-value")[0];scoreEl&&(scoreEl.innerHTML=elObj.value),totalEl.setAttribute("obj",el1)}}else{if(obj.value){if(totalEl){let elObj=eval("("+totalEl.getAttribute("obj")+")");elObj.value&&elObj.value>0?elObj.value=parseFloat(elObj.value)-parseFloat(obj.value):elObj.value=0;let scoreEl=totalEl.getElementsByClassName("hxiong-field-value")[0];scoreEl&&(scoreEl.innerHTML=elObj.value);let el1=JSON.stringify(elObj).replace(/\"/g,"'");totalEl.setAttribute("obj",el1)}obj.value=null;let child=t.getElementsByClassName("hxiong-td-check")[0];child&&(child.style.display="none")}else{obj.value=obj.score;let child=t.getElementsByClassName("hxiong-td-check")[0];if(child&&(child.style.display="inherit"),totalEl){let elObj=eval("("+totalEl.getAttribute("obj")+")");elObj.value&&elObj.value>0?elObj.value=parseFloat(elObj.value)+parseFloat(obj.value):elObj.value=parseFloat(obj.value);let scoreEl=totalEl.getElementsByClassName("hxiong-field-value")[0];scoreEl&&(scoreEl.innerHTML=elObj.value);let el1=JSON.stringify(elObj).replace(/\"/g,"'");totalEl.setAttribute("obj",el1)}}let objStr=JSON.stringify(obj).replace(/\"/g,"'");t.setAttribute("obj",objStr)}console.log("toggle value")}function _checkWayEdit(e,t){if(!t)return!1;let{mode:l}=window;if(console.log("check edit mode",l),l>1)return!0;let o=t.getAttribute("sourceId");return console.log("check edit sourceId",o),!o&&(!(!l||l<1)&&!haveChildTarget(t,"hxiong-field"))}function haveParentTarget(e,t){for(;e.parentNode;)if(e=e.parentNode,console.log(e.tagName),e.tagName==t)return!0;return!1}function haveChildTarget(e,t){try{if(console.log("check childs",e),"string"==typeof e)return!1;let l=e.getElementsByClassName(t);if(l&&l.length>0)return console.log("content include plugin",l),!0;if(!e.children)return!1;for(let l=0;l<e.children.length;l++)return haveChildTarget(e.children[l],t)}catch(e){return console.error(e),!1}}
//# sourceMappingURL=ueditor.extends.js.map